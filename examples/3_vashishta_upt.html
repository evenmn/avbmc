

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Grand-canonical ensemble studies with Vashishta &mdash; avbmc  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MPI parallelisation" href="4_mpi_parallelisation.html" />
    <link rel="prev" title="Grand-canonical simulations with Lennard-Jones" href="2_lennardjones_upt.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> avbmc
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About AVBMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/installation.html">Installing and importing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/installation.html#initializing-system">Initializing system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/system_constants.html">Setting system constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/forcefield.html">Setting forcefield</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/particles.html">Adding particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/boundary.html">Setting boundary conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/constraints.html">Adding constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/moves.html">Adding moves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/sampler.html">Setting sampler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/rng.html">Setting random number generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/run.html">Running the code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/outputs.html">System outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/statistics.html">Statistics</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_lennardjones_nvt.html">Canonical ensemble simulations with Lennard-Jones</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_lennardjones_upt.html">Grand-canonical simulations with Lennard-Jones</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Grand-canonical ensemble studies with Vashishta</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_mpi_parallelisation.html">MPI parallelisation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../for_developers/code_structure.html">Code structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../for_developers/build_cpp.html">Build with g++ (for developers)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../for_developers/code_style.html">Code Style</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">avbmc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Grand-canonical ensemble studies with Vashishta</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/3_vashishta_upt.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="grand-canonical-ensemble-studies-with-vashishta">
<h1>Grand-canonical ensemble studies with Vashishta<a class="headerlink" href="#grand-canonical-ensemble-studies-with-vashishta" title="Permalink to this heading">¶</a></h1>
<p>The Vashishta potential is a class 3 forcefield, meaning that it allows for non-bonded three-body interactions. Thus, the potential is well-suited for the study of triatomic molecules. We will in this example show how water droplets can be sampled in the grand-canonical ensemble (<span class="math notranslate nohighlight">\(\mu\)</span> PT) using AVBMC insertion and deletion moves of water molecules. We use umbrella sampling to sample areas of configuration space that one is usually unlikely to reach (in particular droplet sizes around maximum formation free energy). For practical reasons […], the droplet is forced to be spherical by restricting all oxygen atoms to have at least three oxygen atoms as neighbors.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">avbmc</span> <span class="k">as</span> <span class="nn">mc</span>

<span class="n">system</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">System</span><span class="p">()</span>
<span class="n">system</span><span class="o">.</span><span class="n">set_temp</span><span class="p">(</span><span class="mf">300.</span><span class="p">)</span>

<span class="n">system</span><span class="o">.</span><span class="n">set_forcefield</span><span class="p">(</span><span class="s2">&quot;vashishta&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O.wang.vashishta&quot;</span><span class="p">)</span>

<span class="n">water_mol</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="s2">&quot;water.xyz&quot;</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">add_particles</span><span class="p">(</span><span class="n">water_mol</span><span class="p">)</span>

<span class="n">system</span><span class="o">.</span><span class="n">add_move</span><span class="p">(</span><span class="s2">&quot;trans&quot;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">add_move</span><span class="p">(</span><span class="s2">&quot;avbmcmol&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">water_mol</span><span class="p">)</span>

<span class="n">system</span><span class="o">.</span><span class="n">set_dump</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;mc.xyz&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">])</span>
<span class="n">system</span><span class="o">.</span><span class="n">set_thermo</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;mc.log&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;step&quot;</span><span class="p">,</span> <span class="s2">&quot;atoms&quot;</span><span class="p">,</span> <span class="s2">&quot;poteng&quot;</span><span class="p">])</span>

<span class="n">system</span><span class="o">.</span><span class="n">run_mc</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">write_size_histogram</span><span class="p">(</span><span class="s2">&quot;size_histogram.txt&quot;</span><span class="p">,</span> <span class="n">box_id</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="4_mpi_parallelisation.html" class="btn btn-neutral float-right" title="MPI parallelisation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="2_lennardjones_upt.html" class="btn btn-neutral float-left" title="Grand-canonical simulations with Lennard-Jones" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Even Marius Nordhagen.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>