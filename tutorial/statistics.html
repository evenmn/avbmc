

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Statistics &mdash; avbmc  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Canonical ensemble simulations with Lennard-Jones" href="../examples/1_lennardjones_nvt.html" />
    <link rel="prev" title="System outputs" href="outputs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> avbmc
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About AVBMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing and importing</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#initializing-system">Initializing system</a></li>
<li class="toctree-l1"><a class="reference internal" href="system_constants.html">Setting system constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="forcefield.html">Setting forcefield</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles.html">Adding particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary.html">Setting boundary conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="constraints.html">Adding constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="moves.html">Adding moves</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampler.html">Setting sampler</a></li>
<li class="toctree-l1"><a class="reference internal" href="rng.html">Setting random number generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="run.html">Running the code</a></li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">System outputs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#custom-statistics">Custom statistics</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/1_lennardjones_nvt.html">Canonical ensemble simulations with Lennard-Jones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/2_lennardjones_upt.html">Grand-canonical simulations with Lennard-Jones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/3_vashishta_upt.html">Grand-canonical ensemble studies with Vashishta</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/4_mpi_parallelisation.html">MPI parallelisation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../for_developers/code_structure.html">Code structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../for_developers/build_cpp.html">Build with g++ (for developers)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../for_developers/code_style.html">Code Style</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">avbmc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Statistics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorial/statistics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="statistics">
<h1>Statistics<a class="headerlink" href="#statistics" title="Permalink to this heading">Â¶</a></h1>
<p>Sampling statistics can tell a lot about the simulation and whether or not it was successful. One of the most important metrics for this is the acceptance ratio, which can indicate if the step length was appropriate. In the code, the number of attempts and accepted attempts are stored for each move. They can be found by <code class="code docutils literal notranslate"><span class="pre">move.ndrawn</span></code> and <code class="code docutils literal notranslate"><span class="pre">move.naccept</span></code>, respectively. Additionally, the cummulative CPU-time for each move is stored in <code class="code docutils literal notranslate"><span class="pre">move.cum_time</span></code>. The move statistics can be output by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Label #drawn #accepted acceptance time&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">move</span> <span class="ow">in</span> <span class="n">system</span><span class="o">.</span><span class="n">moves</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">move</span><span class="p">,</span> <span class="n">move</span><span class="o">.</span><span class="n">ndrawn</span><span class="p">,</span> <span class="n">move</span><span class="o">.</span><span class="n">naccept</span><span class="p">,</span> <span class="n">move</span><span class="o">.</span><span class="n">naccept</span><span class="o">/</span><span class="n">move</span><span class="o">.</span><span class="n">ndrawn</span><span class="p">,</span> <span class="n">move</span><span class="o">.</span><span class="n">cum_time</span><span class="p">)</span>
</pre></div>
</div>
<p>On can also call the built-in function <code class="code docutils literal notranslate"><span class="pre">system.print_statistics()</span></code>, which outputs a neat table to the terminal. It might look like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>------------------------------------------------------------------------
<span class="p">|</span><span class="w">    </span>Move<span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="c1">#drawn | #accept | #reject | acc. ratio | CPU-time (s) |</span>
------------------------------------------------------------------------
<span class="p">|</span><span class="w"> </span>Trans<span class="w">       </span><span class="p">|</span><span class="w">    </span><span class="m">492</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">120</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">372</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.243902<span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">0</span>.711072<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>AVBMCMolIn<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">260</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">104</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">156</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.400000<span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">0</span>.076163<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>AVBMCMolOut<span class="w"> </span><span class="p">|</span><span class="w">    </span><span class="m">249</span><span class="w"> </span><span class="p">|</span><span class="w">       </span><span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">249</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">0</span>.000000<span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">0</span>.119231<span class="w"> </span><span class="p">|</span>
------------------------------------------------------------------------
</pre></div>
</div>
<p>For a deeper analysis, more columns can be specified with an argument list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system</span><span class="o">.</span><span class="n">print_statistics</span><span class="p">([</span><span class="s2">&quot;move&quot;</span><span class="p">,</span> <span class="s2">&quot;ndrawn&quot;</span><span class="p">,</span> <span class="s2">&quot;nreject&quot;</span><span class="p">,</span> <span class="s2">&quot;rejtarg&quot;</span><span class="p">,</span> <span class="s2">&quot;rejout&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>which might output something like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>-----------------------------------------------------------------
<span class="p">|</span><span class="w">    </span>Move<span class="w">     </span><span class="p">|</span><span class="w"> </span><span class="c1">#drawn | #reject | #reject out | #reject target |</span>
-----------------------------------------------------------------
<span class="p">|</span><span class="w"> </span>Trans<span class="w">       </span><span class="p">|</span><span class="w">    </span><span class="m">498</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">382</span><span class="w"> </span><span class="p">|</span><span class="w">           </span>-<span class="w"> </span><span class="p">|</span><span class="w">              </span>-<span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>AVBMCMolIn<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">235</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">150</span><span class="w"> </span><span class="p">|</span><span class="w">           </span>-<span class="w"> </span><span class="p">|</span><span class="w">              </span><span class="m">0</span><span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>AVBMCMolOut<span class="w"> </span><span class="p">|</span><span class="w">    </span><span class="m">268</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">268</span><span class="w"> </span><span class="p">|</span><span class="w">           </span><span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w">              </span><span class="m">0</span><span class="w"> </span><span class="p">|</span>
-----------------------------------------------------------------
</pre></div>
</div>
<p>The possible columns are <code class="code docutils literal notranslate"><span class="pre">move</span></code>, <code class="code docutils literal notranslate"><span class="pre">ndrawn</span></code>, <code class="code docutils literal notranslate"><span class="pre">naccept</span></code>, <code class="code docutils literal notranslate"><span class="pre">nreject</span></code>, <code class="code docutils literal notranslate"><span class="pre">accratio</span></code>, <code class="code docutils literal notranslate"><span class="pre">cputime</span></code>, <code class="code docutils literal notranslate"><span class="pre">rejout</span></code> and <code class="code docutils literal notranslate"><span class="pre">rejtarg</span></code>.</p>
<p>A LaTeX style is also under development, which is expected to work like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">latex_table</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">print_statistics</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;latex&quot;</span><span class="p">,</span> <span class="nb">print</span><span class="o">=</span><span class="n">false</span><span class="p">)</span>
</pre></div>
</div>
<section id="custom-statistics">
<h2>Custom statistics<a class="headerlink" href="#custom-statistics" title="Permalink to this heading">Â¶</a></h2>
<p>Not much more statistics is stored in the code itself, but data can easily be stored in Python by using a customized sampling loop. For instance, if one wants to use resampling to estimate the variance of the energy, one would need to store energies after all cycles. This can be done by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">potengs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">system</span><span class="o">.</span><span class="n">run_mc_cycle</span><span class="p">()</span>
    <span class="n">potengs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">poteng</span><span class="p">)</span>
</pre></div>
</div>
<p>Other variables can be stored similarly throughout the sampling.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../examples/1_lennardjones_nvt.html" class="btn btn-neutral float-right" title="Canonical ensemble simulations with Lennard-Jones" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="outputs.html" class="btn btn-neutral float-left" title="System outputs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Even Marius Nordhagen.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>